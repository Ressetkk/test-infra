templates:
  - from: generic.tmpl
    render:
      - to: ../../prow/jobs/control-plane/components/provisioner/provisioner-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-provisioner-test
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C components/provisioner release"
                  run_if_changed: "^components/provisioner/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"

      - to: ../../prow/jobs/control-plane/components/kyma-environment-broker/kyma-environment-broker-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-kyma-environment-broker-test
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C components/kyma-environment-broker release"
                  run_if_changed: "^components/kyma-environment-broker/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"

      - to: ../../prow/jobs/control-plane/components/schema-migrator/schema-migrator-kcp-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-schema-migrator-test
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C components/schema-migrator release"
                  run_if_changed: "^components/schema-migrator/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"

      - to: ../../prow/jobs/control-plane/components/kyma-metrics-collector/kyma-metrics-collector-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-kyma-metrics-collector-test
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C components/kyma-metrics-collector release"
                  run_if_changed: "^components/kyma-metrics-collector/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"

      - to: ../../prow/jobs/control-plane/components/kubeconfig-service/kubeconfig-service-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-kubeconfig-service-test
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C components/kubeconfig-service release"
                  run_if_changed: "^components/kubeconfig-service/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"

      - to: ../../prow/jobs/control-plane/tests/provisioner-tests/provisioner-tests-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-test-provisioner-tests
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C tests/provisioner-tests release"
                  run_if_changed: "^tests/provisioner-tests/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"

      - to: ../../prow/jobs/control-plane/tests/e2e/provisioning/provisioning-test-generic.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/control-plane"
            jobs:
              - jobConfig:
                  name: pull-e2e-provisioning
                  labels:
                    preset-dind-enabled: "true"
                    preset-kind-volume-mounts: "true"
                  command: /bin/bash
                  args:
                    - -c
                    - "service docker start && make -C tests/e2e/provisioning release"
                  run_if_changed: "^tests/e2e/provisioning/|^scripts/"
                inheritedConfigs:
                  global:
                    - "jobConfig_default"
                    - "image_buildpack-golang"
                    - "jobConfig_presubmit"
